function e(e,t){return Array.isArray(t)?t.some((t=>e.indexOf(t)>-1)):e.indexOf(t)>-1}function t(e,r,a,n){var o,l=t,s="";function i(e,t){return e=null!=(e=e[(t=t.pop?t:t.split(".")).shift()])?e:"",0 in t?i(e,t):e}r=Array.isArray(r)?r:r?[r]:[],r=n?0 in r?[]:[1]:r;for(o=0;o<r.length;o++){var c,d="",u=0,f="object"==typeof r[o]?r[o]:{};(f=Object.assign({},a,f))[""]={"":r[o]},e.replace(/([\s\S]*?)({{((\/)|(\^)|#)(.*?)}}|$)/g,(function(e,t,r,a,n,o,h){u?d+=u&&!n||u>1?e:t:(s+=t.replace(/{{{(.*?)}}}|{{(!?)(&?)(>?)(.*?)}}/g,(function(e,t,r,a,n,o){return t?i(f,t):a?i(f,o):n?l(i(f,o),f):r?"":new Option(i(f,o)).innerHTML})),c=o),n?--u||(h=i(f,h),/^f/.test(typeof h)?s+=h.call(f,d,(function(e){return l(e,f)})):s+=l(d,h,f,c),d=""):++u}))}return s}var r={guardian:["#CC0A11","#046DA1","#f28e2c","#76b7b2","#59a14f","#edc949","#af7aa1","#ff9da7","#9c755f","#bab0ab","#000000"],guardian2:["rgb(204, 10, 17)","rgb(4, 109, 161)","#ff7f00","rgb(0, 178, 255)","rgb(245, 189, 44)","rgb(179, 179, 180)","rgb(128, 128, 128)","#000000"],darkmode:["#ffd700","#ea5f94","#13F4EF","#fa8775","#cd34b5","#9d02d7","#0000ff"],"the-crunch":["#ffd700","#ea5f94","#13F4EF","#fa8775","#cd34b5","#9d02d7","#0000ff"]};class a{constructor(e){const t=r.guardian,a="string"==typeof e,n=t=>!e||a?null:e[t],o=e?a?e:e.type:"ordinal",l=n("domain"),s=n("colors");switch(this.divisor=n("divisor"),o){case"linear":this.cScale=d3.scaleLinear().range(t);break;case"threshold":this.cScale=d3.scaleThreshold().range(t);break;case"quantile":this.cScale=d3.scaleQuantile().range(t);break;case"quantize":this.cScale=d3.scaleQuantize().range(t);break;default:this.cScale=d3.scaleOrdinal().range(t)}this.set(l,s)}get(e){const t=this.divisor?e/this.divisor:e;return this.cScale(t)}set(e,t){let a=!1,n=null;"string"==typeof t&&(r[t]?(n=r[t],a=!0):d3[t]?(n=d3[t],a=!0):console.error(`${t} is not part of the color presets or d3 scale chromatic colour scheme`)),Array.isArray(t)&&t.length>0&&(n=t,a=!0),a&&this.cScale.range(n),e&&e.length>0&&this.cScale.domain(e)}}var n=null,o=null,l=null;function s(e){const t=e.replace(/[,|$]/g,""),r=Number(t);return isNaN(r)}async function i(t,r,n,o){const l=o.sort(((e,t)=>e.index-t.index)).map((e=>e.column)),s=function(e,t){const r=t.map((t=>{var r=d3.extent(e.map((e=>e[t.key]))),n={};n.name=t.key;let o=t.values&&t.values.includes(",")?t.values.split(","):""!=t.values?[t.values]:[];o=""==o[0]?r:o;let l=t.colours&&t.colours.includes(",")?t.colours.split(","):["red"];return""==t.colours||t.colours,n.profile=new a({type:t.scale,domain:o,colors:l.length>0?l:["grey"]}),n}));return r}(n,r),i=r.map((e=>e.key)),d=r.map((e=>e.format?(console.log(e.format),e.format.includes(",")?e.format.split(","):[e.format.trim()]):[])),u=d.map((t=>e(t,"date"))),f=r.map((e=>e.graphics?e.graphics:void 0)),h=r.map((e=>e.outta?e.outta:void 0)),m=(r,a)=>!!e(t[a],i)&&s.find((e=>e.name===t[a])).profile.get(r),p=((e,t)=>e.map((e=>t.map((t=>e[t])))))(n,l),g=e=>i.indexOf(t[e])>-1?d[i.indexOf(t[e])]:[""],b=(e,t)=>u[t-1]?Math.floor(new Date(e).getTime()/1e3):e,y=e=>i.indexOf(t[e])>-1?f[i.indexOf(t[e])]:null,v=e=>i.indexOf(t[e])>-1?h[i.indexOf(t[e])]:null;return await p.map(((e,t)=>e.map(((e,t)=>({value:e,sort:b(e,t),format:g(t),color:m(e,t),contrast:c(m(e,t)),graphics:y(t),outta:v(t)})))))}function c(e){if(e){if(0===e.indexOf("#"))return function(e,t=!0){3===e.length&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]);if(6!==e.length)throw new Error("Invalid HEX color.");let r=parseInt(e.slice(0,2),16),a=parseInt(e.slice(2,4),16),n=parseInt(e.slice(4,6),16);if(t)return.299*r+.587*a+.114*n>186?"#000000":"#FFFFFF";return r=(255-r).toString(16),a=(255-a).toString(16),n=(255-n).toString(16),"#"+padZero(r)+padZero(a)+padZero(n)}(e=e.slice(1));{let t=e.includes("#")?function(e){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(e,t,r,a){return t+t+r+r+a+a}));var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}(e.trim()):e;if(e.includes("rgb(")){let r=function(e){let t=e.match(/rgba?\((\d{1,3}), ?(\d{1,3}), ?(\d{1,3})\)?(?:, ?(\d(?:\.\d?))\))?/);return t?[+t[1],+t[2],+t[3]]:[]}(e);t={r:r[0],g:r[1],b:r[1]}}return.299*t.r+.587*t.g+.114*t.b>186?"#000000":"#FFFFFF"}}return"black"}function d(){return this.color&&"shading"==this.format[0]?`style="background-color:${this.color};color:${this.contrast};font-weight:bold;"`:isNaN(this.value)?"":'style=""'}function u(){var t="";if(null!=this.format&&null!=this.value){let r=this.format.map((e=>e.trim())),a=this.value;if(t+=e(r,"$")?"$":"",t+=e(r,"numberFormat")?function(e){const t=Math.abs(e),r=e<0?"-":"";if(t<1e3)return r+t;const a=[{value:1e3,suffix:"k"},{value:1e6,suffix:"m"},{value:1e9,suffix:"bn"}];let n,o;for(let e=0;e<a.length;e++){const{value:r,suffix:l}=a[e],s=parseFloat((t/r).toFixed(1));if(!(s>=1e3&&e<a.length-1)){n=s,o=l;break}}return r+n+o}(a):e(r,"commas")?a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):a,t=e(r,"nozero")?function(e){return 0==e?"":e}(a):t,e(r,"bar")&&this.graphics.max){let e=100/this.graphics.max*this.value,r=e<30?e+5:5;t=`<div class="table-bar-chart"><div class="table-bar" style="background-color: ${this.color?this.color:this.graphics.colour.get(t)}; margin-left: 0%; width: ${e}%;"></div><div class="table-bar-label" style="left:${r}%;color:${e<30?"black":"white"}">${t}</div></div>`}if(e(r,"textColor")&&(t=`<span style="color:${this.color};"><strong>${t}<strong></span>`),e(r,"date")){t=new Date(t).toLocaleDateString("en-AU",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}if(e(r,"rating")){t=`<span style="font-weight:bold;">${t}</span>/${this.outta?this.outta:10}`}}else t=null!=this.value?this.value:"";return t}class f{constructor(e){this.settings=e,this.init()}init(){var e,t,r;e=this.settings.enableShowMore,t=document.querySelector("#button2"),r=document.querySelector("#outer-wrapper"),e?(console.log("Activate"),t.addEventListener("click",(function(){r.classList.toggle("min"),document.getElementById("showbutton").classList.toggle("hide"),document.getElementById("hidebutton").classList.toggle("hide")})),r.classList.toggle("min")):(console.log("Do not Activate"),null!=t&&t.remove()),function(e,t,r,a){var n="",o=document.head||document.getElementsByTagName("head")[0],l=document.createElement("style");n="@media (max-width: 30em) {",e.map(((e,t)=>{n+=`.collapse-true table tbody tr td:nth-child(${t+1}) span.header-prefix::before { content: '${e}: '; font-weight: 600; }`})),n+="}",n+="th {\n\t  position: sticky!Important;\n\t  top: 0;\n\t}",r&&!a&&t>10&&(n+="table {\n\t\t  text-align: left;\n\t\t  border-collapse: collapse; \n\t\t  position: relative;\n\t\t}",n+="#yacht__table__wrapper {\n\t\t\theight: 480px;\n\t\t\toverflow: auto;\n\t\t\ttouch-action: auto;\n\t\t}"),l.type="text/css",l.styleSheet?l.styleSheet.cssText=n:l.appendChild(document.createTextNode(n)),o.appendChild(l)}(this.settings.keys,this.settings.data.length,this.settings.enableScroll,this.settings.enableShowMore),this.render()}render(){let{modules:e,height:r,width:a,isMobile:c,colors:f,datum:h,title:m,subtitle:p,footnote:g,source:b,data:y,keys:v,cols:x,userkey:w,type:S,enableSearch:k,enableSort:$,enableShowMore:F,enableScroll:N,aria:E,dropdown:L,columns:C}=this.settings;const O=document.querySelector("#yacht__table"),_=document.querySelector("#search-field");O.innerHTML="";function A(){const e=document.querySelector("#yacht__table tbody"),r=t('{{#rows}}\n    <tr>\n        {{#item}}\n            <td {{#styleCheck}}{{/styleCheck}} class="column"><div class="wrap"><span class="header-prefix"></span><span>{{#formatedNumber}}{{/formatedNumber}}</span></div></td>\n        {{/item}}\n    </tr>\n{{/rows}}',{rows:(""!==_.value?y.filter((e=>{return t=e.map((e=>Object.values(e)[0])),r=_.value,!!t.toString().toLowerCase().includes(r.toLowerCase());var t,r})):y).map(((e,t)=>({index:t,item:e}))),styleCheck:d,formatedNumber:u});e.innerHTML=r}!function(e,t,r){let a=e.createTHead().insertRow();for(let e of t){let t=document.createElement("th");t.classList.add("column-header");let n=document.createElement("SPAN"),o=e.includes("unknown title")?"":e,l=document.createTextNode(o);if(t.appendChild(n),n.appendChild(l),"TRUE"===r){let e=document.createElement("DIV");e.classList.add("toggle-wrapper"),t.appendChild(e)}a.appendChild(t)}e.appendChild(document.createElement("tbody")).classList.add("table-body")}(O,C.map((e=>e.label)),$),i(v,w,y,C).then((e=>function(e){y=e,A(),document.querySelector("#yacht__table tr").addEventListener("click",(e=>function(e){y=y.sort(function(e){var t,r;return n=n!==e?e:null,function(a,o){return t="string"!=typeof a[e].sort||s(a[e].sort)?a[e].sort:parseFloat(a[e].sort.replace(/[,|$]/g,"")),r="string"!=typeof o[e].sort||s(o[e].sort)?o[e].sort:parseFloat(o[e].sort.replace(/[,|$]/g,"")),"<svg>"==(""+t).substring(0,5)?t<r?n!==e?1:-1:t>r?n!==e?-1:1:0:t<r?n!==e?-1:1:t>r?n!==e?1:-1:0}}(e.target.cellIndex)),function(e){const t=document.querySelectorAll("#yacht__table .column-header"),r=document.querySelector("#yacht__table");for(var a=0;a<t.length;a++)t[a].className="column-header";o===e.target&&!1===l?(e.target.className="column-header sorted-reversed",l=!0):(e.target.className="column-header sorted",l=!1),function(e,t){if(e.className){var r=" "+t+" ";return-1!==(" "+e.className+" ").indexOf(r)}return!1}(r,"table-sorted")||(r.className="table-sorted"),o=e.target}(e),A()}(e))),_.addEventListener("input",(()=>A())),k&&(document.getElementById("search-container").style.display="block")}(e)))}}export{f as default};
